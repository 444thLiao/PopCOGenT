# Purpose
Finds core genome sweep regions by identifying low diversity, monophyletic (within a population) regions in a whole-genome alignment. 

# Important caveats

* This module is only designed to detect sweeps that differentiate the most closely related populations, i.e., populations that are still connected by some gene flow. This corresponds to populations that share the same `Main_cluster` designation from PopCOGenT but different `sub_cluster` assignments. For example, this can detect sweeps that differentiate population `0.0` from population `0.1` but not sweeps differentiating population `0.0` from population `1.0`. 

* Because this module requires the creation of a whole genome alignment and the generation of thousands of phylogenies, we have only been successful at using it for examining groups of less than 100 genomes. That is, the `Main_cluster` examined should not have more than 100 members.

# Setup

Requires a `*.cluster.tab.txt` file generated by PopCOGenT and the associated `.fasta` genome files. Also requires specifying a `focus_population`, i.e., one of the populations in the `Cluster_ID` column of the `*.cluster.tab.txt` file. The file should be filtered to only include the strains belonging to a single `Main_cluster` of interest. 

# Output
`align/*.core.fasta`: The concatenated core genome alignment of all genomes
`*.core_sweeps.csv`: The positions (in the coordinates of the whole genome alignment) of core genome sweeps.
* `Start`: Start position indexed at 0.
* `End`: End position indexed at 0.
* `Start tree`: Tree identifier that indicates the 100 SNP window where the region starts.
* `End tree`: Tree identifier that indicates the 100 SNP window where the region ends.
* `pop_pi`: Within-population nucleotide diversity in the sweep region
* `Length`: Length of sweep region
* `Midpoint`: Midpoint of sweep region in the coordinates of the multiple genome alignment.
* `ci_low` and `ci_high`: 95% confidence interval for nucleotide diversity given average genome-wide nucleotide diversity within the population.

# Usage

Set all relevant parameters in `phybreak_parameters.txt`. Load PopCOGenT environment with `source activate PopCOGenT`. Run scripts in sequence from 1-7 (i.e., `python {script_name}`). For each population for which you wish to find sweeps, change the `focus_population` parameter and re-run scripts 3-7.
